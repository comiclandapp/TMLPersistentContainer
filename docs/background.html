<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
 
    <link rel="stylesheet" href="css/fw2020.css">
    
    <title>Background  Reference</title>
    
  </head>
  <body data-root-path="./">

  <header class="j2-header">
  <div class="navbar navbar-expand navbar-dark j2-titlebar">
    <a class="sr-only-focusable sr-only font-weight-slightly-bold pr-2" href="#main-content">Skip to main content</a>
    <a class="nav-item nav-link pl-0 pt-1 pr-2 d-md-none" id="nav-toggle-button" role="button" aria-controls="nav-column" aria-expanded="false" aria-label="Toggle navigation" href="#">
      <span class="navbar-toggler-icon"></span>
    </a>
  
    <div style="align-items-baseline">
      <div class="navbar-brand mr-1 font-weight-slightly-bold">
        <a href="index.html">TMLPersistentContainer 5.0.0</a>
      </div>
      <span class="navbar-text j2-coverage font-weight-slightly-bold small d-none d-lg-inline-block mr-2">(100% documented)</span>
    </div>
  
    <div class="navbar-nav ml-auto justify-content-end flex-fill">
  
      <form class="form-inline d-none d-md-flex" role="search">
        <input class="form-control form-control-sm w-100" type="search" placeHolder="Search" aria-label="Search" aria-keyshortcuts="/" data-search-format="span">
      </form>
  
      <a class="nav-item nav-link d-none d-sm-inline" rel="external" href="https://github.com/johnfairh/TMLPersistentContainer">
        <svg class="j2-title-svg" xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 16 16"><title>Open on GitHub</title><path fill="currentcolor" fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
        </svg>
      </a>
  
    </div>
  </div>
  
  <!-- narrow-style searchbar -->
  
  <div class="container-fluid j2-titlebar d-md-none">
    <div class="row">
      <div class="col">
        <form class="pb-2">
          <input class="form-control form-control-sm" type="search" placeHolder="Search" aria-label="Search" aria-keyshortcuts="/" data-search-format="div">
        </form>
      </div>
    </div>
  </div>

  <!-- breadcrumb bar, jazzy doesn't really support -->

  <nav aria-label="breadcrumb" class="small">
    <ol class="breadcrumb j2-breadcrumb">
      <li class="breadcrumb-item"><a href="index.html">TMLPersistentContainer Reference</a></li>
      <li class="breadcrumb-item" aria-current="page">Background  Reference</li>
    </ol>
  </nav>

  </header>

  <div class="container-fluid">
    <div class="row">
      <div class="col-auto d-none d-md-flex flex-column j2-nav" id="nav-column">
        <nav aria-label="swift" class="j2-swift">
          <ul class="j2-nav-list">
            <li class="j2-nav-group">
              <a class="j2-nav-item" href="Guides.html">Guides</a>
              <ul class="j2-nav-sublist">
                <li>
                  <a class="j2-nav-item" href="background.html">Background</a>
                </li>
                <li>
                  <a class="j2-nav-item" href="usage.html">Usage</a>
                </li>
              </ul>
            </li>
            <li class="j2-nav-group">
              <a class="j2-nav-item" href="Main%20APIs.html">Main APIs</a>
              <ul class="j2-nav-sublist">
                <li>
                  <a class="j2-nav-item" href="Classes/PersistentContainer.html">PersistentContainer</a>
                </li>
                <li>
                  <a class="j2-nav-item" href="Classes/PersistentCloudKitContainer.html">PersistentCloudKitContainer</a>
                </li>
                <li>
                  <a class="j2-nav-item" href="Enums/ModelVersionOrder.html">ModelVersionOrder</a>
                </li>
                <li>
                  <a class="j2-nav-item" href="Enums/MigrationError.html">MigrationError</a>
                </li>
                <li>
                  <a class="j2-nav-item" href="Protocols/MigrationDelegate.html">MigrationDelegate</a>
                </li>
              </ul>
            </li>
            <li class="j2-nav-group">
              <a class="j2-nav-item" href="Logging%20APIs.html">Logging APIs</a>
              <ul class="j2-nav-sublist">
                <li>
                  <a class="j2-nav-item" href="Structs/LogMessage.html">LogMessage</a>
                </li>
                <li>
                  <a class="j2-nav-item" href="Enums/LogLevel.html">LogLevel</a>
                </li>
              </ul>
            </li>
          </ul>
        </nav>
      </div>
      <main class="col col-xl-8 j2-article px-lg-4 px-xl-5" id="article-column">
        <article class="j2-article-wrapper" id="main-content">

        <!-- todo top of article.... -->

        <section>

          <div class="clearfix">
            <!--
TMLPersistentContainer
Usage.md
Distributed under the ISC license, see LICENSE.
-->
<h1 id='background' class='j2-anchor heading'><span data-anchor-id=background>Background</span></h1>

<p><em>This document is background on the Core Data
migration-from-multiple-model-versions problem. If you are a developer who
uses Core Data and knows all about this then you should probably <a href="usage.html">read the user
guide instead</a>.</em></p>

<p>Developers change their Core Data models over time to support new requirements.
If a user upgrades the app on their device and the new version of the app has a
new version of the Core Data model then the app&rsquo;s Core Data stores have to be
<em>migrated</em> to match the new version of the model.  </p>

<p>A Core Data <em>mapping model</em> contains rules to migrate a store from one version
of a model to another. Developers create explicit mapping models in Xcode
or can rely on inferred mapping models created at run-time by Core Data for
simple model changes. These inferred mapping models are usually faster and use
less memory.</p>

<p>Apps have to support migration from all possible installed model versions
otherwise users are stuck unable to upgrade. The standard
<code><a href="https://developer.apple.com/documentation/coredata/nspersistentcontainer/">NSPersistentContainer</a></code> API allows for a single mapping model to be used when a
store is loaded. This leaves developers with a problem when, for example, they
want to deploy model version 5 that has to support migration from any of the
previous versions 1-4.</p>

<p><strong>Option 1</strong> is to consider all the possible migrations from versions 1-4 to 5.
If the inferred mapping model is sufficient then great, no problem. If it is
not then the developer has to create a mapping model in Xcode to perform the
necessary transformations.  </p>

<p><strong>Option 2</strong> is to use multiple sequential migrations at run-time. So if the
user&rsquo;s store happens to be at version 2 then it would first be migrated from
2-&gt;3, then 3-&gt;4, and finally 4-&gt;5.</p>

<p>Option 1 requires more mapping models to be created, tested, and maintained.
It can need more actual code to be written, tested, and maintained depending
on the requirements for custom entity mappings. The benefit is that users see
a single migration step and so the speediest app launch possible.</p>

<p>Option 2 requires some one-off app code to perform the sequential migrations.
Users who have been tardy updating their device see a one-time longer app
launch time after the update as their stores are migrated multiple times.</p>

<p>Option 2 is generally the best choice and several libraries exist to assist
with the mechanics.</p>

<p>This library, <code>TMLPersistentContainer</code>, is another such assistant. It allows
developers to minimize the long migration sequences that can occur in mature
apps and to take advantage of the light-weight migrations enabled by inferred
mapping models.</p>

<p><a href="usage.html">Read the user guide to find out how</a>.</p>

          </div>
        </section>


        </article>
      </main>

      <!-- aux nav -->

      <div class="col-xl d-none d-xl-block j2-aux-nav" id="aux-nav-column">
        <div class="j2-aux-nav-wrapper">
          <h6 class="j2-inline-heading">Topics</h6>
          <nav aria-label="page">
            <ul class="j2-aux-group">
              <li><a href="#">Declaration</a></li>
            </ul>
          </nav>
          <h6 class="j2-inline-heading">Actions</h6>
          <ul class="j2-aux-group">
            <li><a class="j2-aux-action" id="action-search" href="#" role="button" aria-keyshortcuts="/">Search (/)</a></li>
            <li><a class="j2-aux-action" id="action-collapse" href="#" role="button" aria-keyshortcuts="a">
              <span id="action-collapse-expand">Open all (a)</span>
              <span id="action-collapse-collapse" class="d-none">Close all (a)</span>
            </a></li>
          </ul>
        </div>
      </div>

    </div> <!-- end row -->

    <footer class="row">
      <div class="col j2-footer small pt-2">
        <p><p>Distributed under the ISC license.  Maintained by John Fairhurst.</p></p>
        <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.13.1</a>-<a class="link" href="https://github.com/johnfairh/jazzy" target="_blank" rel="external">bebop</a>, originally a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.  Theme from <a href="https://github.com/johnfairh/J2">J2</a>.</p>
      </div>
    </footer>
  </div> <!-- container -->

  <script src="js/dependencies.min.js"></script>
  <script src="js/fw2020.js"></script>
  </body>

</html>
