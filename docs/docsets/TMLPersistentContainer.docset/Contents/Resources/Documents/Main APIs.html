<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
 
    <link rel="stylesheet" href="css/fw2020.css">
    
    <title>Main APIs  Reference</title>
    
  </head>
  <body data-root-path="./">

  <header class="j2-header">
  <div class="navbar navbar-expand navbar-dark j2-titlebar">
    <a class="sr-only-focusable sr-only font-weight-slightly-bold pr-2" href="#main-content">Skip to main content</a>
    <a class="nav-item nav-link pl-0 pt-1 pr-2 d-md-none" id="nav-toggle-button" role="button" aria-controls="nav-column" aria-expanded="false" aria-label="Toggle navigation" href="#">
      <span class="navbar-toggler-icon"></span>
    </a>
  
    <div style="align-items-baseline">
      <div class="navbar-brand mr-1 font-weight-slightly-bold">
        <a href="index.html">TMLPersistentContainer 5.0.0</a>
      </div>
      <span class="navbar-text j2-coverage font-weight-slightly-bold small d-none d-lg-inline-block mr-2">(100% documented)</span>
    </div>
  
    <div class="navbar-nav ml-auto justify-content-end flex-fill">
  
      <form class="form-inline d-none d-md-flex" role="search">
        <input class="form-control form-control-sm w-100" type="search" placeHolder="Search" aria-label="Search" aria-keyshortcuts="/" data-search-format="span">
      </form>
  
      <a class="nav-item nav-link d-none d-sm-inline" rel="external" href="https://github.com/johnfairh/TMLPersistentContainer">
        <svg class="j2-title-svg" xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 16 16"><title>Open on GitHub</title><path fill="currentcolor" fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
        </svg>
      </a>
  
    </div>
  </div>
  
  <!-- narrow-style searchbar -->
  
  <div class="container-fluid j2-titlebar d-md-none">
    <div class="row">
      <div class="col">
        <form class="pb-2">
          <input class="form-control form-control-sm" type="search" placeHolder="Search" aria-label="Search" aria-keyshortcuts="/" data-search-format="div">
        </form>
      </div>
    </div>
  </div>

  <!-- breadcrumb bar, jazzy doesn't really support -->

  <nav aria-label="breadcrumb" class="small">
    <ol class="breadcrumb j2-breadcrumb">
      <li class="breadcrumb-item"><a href="index.html">TMLPersistentContainer Reference</a></li>
      <li class="breadcrumb-item" aria-current="page">Main APIs  Reference</li>
    </ol>
  </nav>

  </header>

  <div class="container-fluid">
    <div class="row">
      <div class="col-auto d-none d-md-flex flex-column j2-nav" id="nav-column">
        <nav aria-label="swift" class="j2-swift">
          <ul class="j2-nav-list">
            <li class="j2-nav-group">
              <a class="j2-nav-item" href="Guides.html">Guides</a>
              <ul class="j2-nav-sublist">
                <li>
                  <a class="j2-nav-item" href="background.html">Background</a>
                </li>
                <li>
                  <a class="j2-nav-item" href="usage.html">Usage</a>
                </li>
              </ul>
            </li>
            <li class="j2-nav-group">
              <a class="j2-nav-item" href="Main%20APIs.html">Main APIs</a>
              <ul class="j2-nav-sublist">
                <li>
                  <a class="j2-nav-item" href="Classes/PersistentContainer.html">PersistentContainer</a>
                </li>
                <li>
                  <a class="j2-nav-item" href="Classes/PersistentCloudKitContainer.html">PersistentCloudKitContainer</a>
                </li>
                <li>
                  <a class="j2-nav-item" href="Enums/ModelVersionOrder.html">ModelVersionOrder</a>
                </li>
                <li>
                  <a class="j2-nav-item" href="Enums/MigrationError.html">MigrationError</a>
                </li>
                <li>
                  <a class="j2-nav-item" href="Protocols/MigrationDelegate.html">MigrationDelegate</a>
                </li>
              </ul>
            </li>
            <li class="j2-nav-group">
              <a class="j2-nav-item" href="Logging%20APIs.html">Logging APIs</a>
              <ul class="j2-nav-sublist">
                <li>
                  <a class="j2-nav-item" href="Structs/LogMessage.html">LogMessage</a>
                </li>
                <li>
                  <a class="j2-nav-item" href="Enums/LogLevel.html">LogLevel</a>
                </li>
              </ul>
            </li>
          </ul>
        </nav>
      </div>
      <main class="col col-xl-8 j2-article px-lg-4 px-xl-5" id="article-column">
        <article class="j2-article-wrapper" id="main-content">

        <!-- todo top of article.... -->

        <section>
          <header>
            <h1 class="j2-anchor">
              <span>Main APIs</span>
            </h1>
          </header>

          <div class="clearfix">
            <p>These types form the main API.</p>

          </div>
        </section>

        <hr/>
        <section>
          <h1 class="sr-only">Topics</h1>
          <section>
            <section id="cMTMLPersistentContainerobjccsPersistentContainer" class="j2-item">
              <a name="//apple_ref/cpp/Class/PersistentContainer" class="dashAnchor"></a>
              <h4 class="sr-only">PersistentContainer</h4>
              <a class="j2-item-title" data-toggle="collapse" href="#_cMTMLPersistentContainerobjccsPersistentContainer" role="button" aria-expanded="false" aria-controls="_cMTMLPersistentContainerobjccsPersistentContainer"><code>PersistentContainer</code></a>
              <div class="collapse j2-item-popopen-wrapper" id="_cMTMLPersistentContainerobjccsPersistentContainer">
                <div class="j2-item-popopen">
                  <div class="j2-item-popopen-pointer" role="none"></div>
                  <div class="j2-item-popopen-body">
                    <div class="clearfix">
                      <p>A container for a Core Data stack that provides automatic multi-step shortest-path
persistent store migration.</p>

<p>This is a drop-in replacement for <code><a href="https://developer.apple.com/documentation/coredata/nspersistentcontainer/">NSPersistentContainer</a></code> that automatically detects
and performs multi-step store migration as part of the <code>loadPersistentStores</code> method.</p>

<p>The container searches for models and mapping models, then constructs the
best sequence in which to migrate stores. It prefers to use explicit mapping models
over inferred mapping models when there is a choice. Progress and status can be
reported back to the client code.</p>

<p>See <a href="https://johnfairh.github.io/TMLPersistentContainer/usage.html">the user guide</a> for more details.</p>

<p>See <code><a href="Classes/PersistentCloudKitContainer.html">PersistentCloudKitContainer</a></code> for a version capable of managing both
CloudKit-backed and non-cloud stores..</p>

                    </div>
                    <h5>Declaration</h5>
                    <div class="j2-item-declaration">
                    <div class="j2-callout-title" role="heading" aria-level="6">Swift</div>
                    <pre><code class="language-swift">@available(OSX 10.12, iOS 10.0, tvOS 10.0, watchOS 3.0, *)
open class PersistentContainer : <a href="https://developer.apple.com/documentation/coredata/nspersistentcontainer/">NSPersistentContainer</a>, PersistentContainerMigratable, PersistentContainerProtocol, LogMessageEmitter</code></pre>
                    </div>
                    <nav class="j2-item-nav" aria-label="item details">
                      <span class="j2-item-nav-item"><a href="Classes/PersistentContainer.html">Show members</a></span>
                      <span class="j2-item-nav-item"><a href="https://github.com/johnfairh/TMLPersistentContainer/tree/master/Sources/PersistentContainer.swift#L145-L271">Show on GitHub</a></span>
                    </nav>
                  </div>
                <div>
              </div>
            </section>
            <section id="cMTMLPersistentContainerobjccsPersistentCloudKitContainer" class="j2-item">
              <a name="//apple_ref/cpp/Class/PersistentCloudKitContainer" class="dashAnchor"></a>
              <h4 class="sr-only">PersistentCloudKitContainer</h4>
              <a class="j2-item-title" data-toggle="collapse" href="#_cMTMLPersistentContainerobjccsPersistentCloudKitContainer" role="button" aria-expanded="false" aria-controls="_cMTMLPersistentContainerobjccsPersistentCloudKitContainer"><code>PersistentCloudKitContainer</code></a>
              <div class="collapse j2-item-popopen-wrapper" id="_cMTMLPersistentContainerobjccsPersistentCloudKitContainer">
                <div class="j2-item-popopen">
                  <div class="j2-item-popopen-pointer" role="none"></div>
                  <div class="j2-item-popopen-body">
                    <div class="clearfix">
                      <p>A container for a Core Data stack that provides automatic multi-step shortest-path
persistent store migration, capable of managing both CloudKit-backed and non-cloud stores.</p>

<p>This is a drop-in replacement for <code><a href="https://developer.apple.com/documentation/coredata/nspersistentcloudkitcontainer/">NSPersistentCloudKitContainer</a></code> that
automatically detects and performs multi-step store migration as part of the
<code>loadPersistentStores</code> method.</p>

<p>The container searches for models and mapping models, then constructs the
best sequence in which to migrate stores. It prefers to use explicit mapping models
over inferred mapping models when there is a choice. Progress and status can be
reported back to the client code.</p>

<p>See <a href="https://johnfairh.github.io/TMLPersistentContainer/usage.html">the user guide</a> for more details.</p>

<p>See <code><a href="Classes/PersistentContainer.html">PersistentContainer</a></code> for a version that does not support CloudKit-backed stores.</p>

                    </div>
                    <h5>Declaration</h5>
                    <div class="j2-item-declaration">
                    <div class="j2-callout-title" role="heading" aria-level="6">Swift</div>
                    <pre><code class="language-swift">@available(OSX 10.15, iOS 13.0, tvOS 13.0, watchOS 6.0, *)
open class PersistentCloudKitContainer : <a href="https://developer.apple.com/documentation/coredata/nspersistentcloudkitcontainer/">NSPersistentCloudKitContainer</a>, PersistentContainerMigratable, PersistentContainerProtocol, LogMessageEmitter</code></pre>
                    </div>
                    <nav class="j2-item-nav" aria-label="item details">
                      <span class="j2-item-nav-item"><a href="Classes/PersistentCloudKitContainer.html">Show members</a></span>
                      <span class="j2-item-nav-item"><a href="https://github.com/johnfairh/TMLPersistentContainer/tree/master/Sources/PersistentCloudKitContainer.swift#L28-L149">Show on GitHub</a></span>
                    </nav>
                  </div>
                <div>
              </div>
            </section>
            <section id="s22TMLPersistentContainer17ModelVersionOrderO" class="j2-item">
              <a name="//apple_ref/cpp/Enum/ModelVersionOrder" class="dashAnchor"></a>
              <h4 class="sr-only">ModelVersionOrder</h4>
              <a class="j2-item-title" data-toggle="collapse" href="#_s22TMLPersistentContainer17ModelVersionOrderO" role="button" aria-expanded="false" aria-controls="_s22TMLPersistentContainer17ModelVersionOrderO"><code>ModelVersionOrder</code></a>
              <div class="collapse j2-item-popopen-wrapper" id="_s22TMLPersistentContainer17ModelVersionOrderO">
                <div class="j2-item-popopen">
                  <div class="j2-item-popopen-pointer" role="none"></div>
                  <div class="j2-item-popopen-body">
                    <div class="clearfix">
                      <p>A rule for ordering model versions.  The persistent container performs automatic multi-step
migration in the direction defined by this rule, which operates on the names of the model
version.
Note that the <em>model version</em> here is the part of its filename before &lsquo;.xcdatamodel&rsquo; &ndash;
<em>not</em> the optional &lsquo;Model Version Identifier&rsquo; that you can set in the model&rsquo;s properties panel.</p>

                    </div>
                    <h5>Declaration</h5>
                    <div class="j2-item-declaration">
                    <div class="j2-callout-title" role="heading" aria-level="6">Swift</div>
                    <pre><code class="language-swift">@available(OSX 10.12, iOS 10.0, tvOS 10.0, watchOS 3.0, *)
public enum ModelVersionOrder</code></pre><pre><code class="language-swift">extension ModelVersionOrder: <a href="https://developer.apple.com/documentation/swift/customstringconvertible/">CustomStringConvertible</a></code></pre>
                    </div>
                    <nav class="j2-item-nav" aria-label="item details">
                      <span class="j2-item-nav-item"><a href="Enums/ModelVersionOrder.html">Show members</a></span>
                      <span class="j2-item-nav-item"><a href="https://github.com/johnfairh/TMLPersistentContainer/tree/master/Sources/ModelVersionOrder.swift#L17-L45">Show on GitHub</a></span>
                    </nav>
                  </div>
                <div>
              </div>
            </section>
            <section id="s22TMLPersistentContainer14MigrationErrorO" class="j2-item">
              <a name="//apple_ref/cpp/Enum/MigrationError" class="dashAnchor"></a>
              <h4 class="sr-only">MigrationError</h4>
              <a class="j2-item-title" data-toggle="collapse" href="#_s22TMLPersistentContainer14MigrationErrorO" role="button" aria-expanded="false" aria-controls="_s22TMLPersistentContainer14MigrationErrorO"><code>MigrationError</code></a>
              <div class="collapse j2-item-popopen-wrapper" id="_s22TMLPersistentContainer14MigrationErrorO">
                <div class="j2-item-popopen">
                  <div class="j2-item-popopen-pointer" role="none"></div>
                  <div class="j2-item-popopen-body">
                    <div class="clearfix">
                      <p>Errors that can occur preventing persistent store loading, passed into the callback given to
<code><a href="Classes/PersistentContainer.html#cMTMLPersistentContainerobjccsPersistentContainerimloadPersistentStoresWithCompletionHandler">PersistentContainer.loadPersistentStores(...)</a></code> or
<code><a href="Classes/PersistentCloudKitContainer.html#cMTMLPersistentContainerobjccsPersistentCloudKitContainerimloadPersistentStoresWithCompletionHandler">PersistentCloudKitContainer.loadPersistentStores(...)</a></code>.</p>

<p>When any of these unusual conditions occurs, the persistent container provides a lot of
human-readable (-ish) information to the logging interface. The first step to debugging
one of these errors is to read that text and try to make sense of it.</p>

                    </div>
                    <h5>Declaration</h5>
                    <div class="j2-item-declaration">
                    <div class="j2-callout-title" role="heading" aria-level="6">Swift</div>
                    <pre><code class="language-swift">@available(OSX 10.12, iOS 10.0, tvOS 10.0, watchOS 3.0, *)
public enum MigrationError : <a href="https://developer.apple.com/documentation/accelerate/quadrature/error/">Error</a></code></pre><pre><code class="language-swift">extension MigrationError: <a href="https://developer.apple.com/documentation/swift/customstringconvertible/">CustomStringConvertible</a></code></pre>
                    </div>
                    <nav class="j2-item-nav" aria-label="item details">
                      <span class="j2-item-nav-item"><a href="Enums/MigrationError.html">Show members</a></span>
                      <span class="j2-item-nav-item"><a href="https://github.com/johnfairh/TMLPersistentContainer/tree/master/Sources/MigrationError.swift#L20-L84">Show on GitHub</a></span>
                    </nav>
                  </div>
                <div>
              </div>
            </section>
            <section id="s22TMLPersistentContainer17MigrationDelegateP" class="j2-item">
              <a name="//apple_ref/cpp/Protocol/MigrationDelegate" class="dashAnchor"></a>
              <h4 class="sr-only">MigrationDelegate</h4>
              <a class="j2-item-title" data-toggle="collapse" href="#_s22TMLPersistentContainer17MigrationDelegateP" role="button" aria-expanded="false" aria-controls="_s22TMLPersistentContainer17MigrationDelegateP"><code>MigrationDelegate</code></a>
              <div class="collapse j2-item-popopen-wrapper" id="_s22TMLPersistentContainer17MigrationDelegateP">
                <div class="j2-item-popopen">
                  <div class="j2-item-popopen-pointer" role="none"></div>
                  <div class="j2-item-popopen-body">
                    <div class="clearfix">
                      <p>A delegate that can be provided to <code><a href="Classes/PersistentContainer.html">PersistentContainer</a></code> or <code><a href="Classes/PersistentCloudKitContainer.html">PersistentCloudKitContainer</a></code>
to receive events describing the progress of migrations. These events can be used to update a user
interface or for app internal logging.</p>

<p>All methods are called while <code><a href="Classes/PersistentContainer.html#cMTMLPersistentContainerobjccsPersistentContainerimloadPersistentStoresWithCompletionHandler">PersistentContainer.loadPersistentStores(...)</a></code> is active.
If <em>any</em> of the <code><a href="https://developer.apple.com/documentation/coredata/nspersistentstoredescription/">NSPersistentStoreDescription</a></code>s have the <code>shouldAddStoreAsynchronously</code> flag
set to <code>true</code> then all methods are called on a private background queue. If all of the store
descriptions have the flag set to <code>false</code> then the methods are called on the same queue on which
<code><a href="Classes/PersistentContainer.html#cMTMLPersistentContainerobjccsPersistentContainerimloadPersistentStoresWithCompletionHandler">PersistentContainer.loadPersistentStores(...)</a></code> was called.</p>

<p>The stores in <code>PersistentContainer.persistentStoreDescriptions</code> are processed sequentially.
Stores that are not migratable (not on disk) are ignored and do not represent in this delegate.</p>

<p>A store that does not require migration (the normal case!) sees the sequence:</p>

<ol>
<li>willConsiderStore</li>
<li>willNotMigrateStore</li>
</ol>

<p>A store requiring a 2-step migration sees the sequence:</p>

<ol>
<li>willConsiderStore</li>
<li>willMigrateStore - totalSteps=2</li>
<li>willSingleMigrateStore - stepsRemaining=2</li>
<li>willSingleMigrateStore - stepsRemaining=1</li>
<li>didMigrateStore</li>
</ol>

<p>Errors can occur at any point following <code>willConsiderStore</code> for example:</p>

<ol>
<li>willConsiderStore</li>
<li>willMigrateStore - totalSteps=8</li>
<li>didFailToMigrateStore</li>
</ol>

                    </div>
                    <h5>Declaration</h5>
                    <div class="j2-item-declaration">
                    <div class="j2-callout-title" role="heading" aria-level="6">Swift</div>
                    <pre><code class="language-swift">@available(OSX 10.12, iOS 10.0, tvOS 10.0, watchOS 3.0, *)
public protocol MigrationDelegate : AnyObject</code></pre>
                    </div>
                    <nav class="j2-item-nav" aria-label="item details">
                      <span class="j2-item-nav-item"><a href="Protocols/MigrationDelegate.html">Show members</a></span>
                      <span class="j2-item-nav-item"><a href="https://github.com/johnfairh/TMLPersistentContainer/tree/master/Sources/MigrationDelegate.swift#L44-L120">Show on GitHub</a></span>
                    </nav>
                  </div>
                <div>
              </div>
            </section>
          </section>
        </section>

        </article>
      </main>

      <!-- aux nav -->

      <div class="col-xl d-none d-xl-block j2-aux-nav" id="aux-nav-column">
        <div class="j2-aux-nav-wrapper">
          <h6 class="j2-inline-heading">Topics</h6>
          <nav aria-label="page">
            <ul class="j2-aux-group">
              <li><a href="#">Declaration</a></li>
            </ul>
          </nav>
          <h6 class="j2-inline-heading">Actions</h6>
          <ul class="j2-aux-group">
            <li><a class="j2-aux-action" id="action-search" href="#" role="button" aria-keyshortcuts="/">Search (/)</a></li>
            <li><a class="j2-aux-action" id="action-collapse" href="#" role="button" aria-keyshortcuts="a">
              <span id="action-collapse-expand">Open all (a)</span>
              <span id="action-collapse-collapse" class="d-none">Close all (a)</span>
            </a></li>
          </ul>
        </div>
      </div>

    </div> <!-- end row -->

    <footer class="row">
      <div class="col j2-footer small pt-2">
        <p><p>Distributed under the ISC license.  Maintained by John Fairhurst.</p></p>
        <p>Generated by <a class="link" href="https://github.com/realm/jazzy" target="_blank" rel="external">jazzy ♪♫ v0.13.1</a>-<a class="link" href="https://github.com/johnfairh/jazzy" target="_blank" rel="external">bebop</a>, originally a <a class="link" href="https://realm.io" target="_blank" rel="external">Realm</a> project.  Theme from <a href="https://github.com/johnfairh/J2">J2</a>.</p>
      </div>
    </footer>
  </div> <!-- container -->

  <script src="js/dependencies.min.js"></script>
  <script src="js/fw2020.js"></script>
  </body>

</html>
